USE DATABASE CALIDAD
;


DROP TABLE CP_AUDIT CASCADE CONSTRAINTS
;
DROP TABLE CP_AUTOR CASCADE CONSTRAINTS
;
DROP TABLE CP_CAMPANIA CASCADE CONSTRAINTS
;
DROP TABLE CP_CLIENTE CASCADE CONSTRAINTS
;
DROP TABLE CP_CONSTANTE CASCADE CONSTRAINTS
;
DROP TABLE CP_DETALLE_AUDIT CASCADE CONSTRAINTS
;
DROP TABLE CP_ESTADO_SEGUIMIENTO CASCADE CONSTRAINTS
;
DROP TABLE CP_PERFIL CASCADE CONSTRAINTS
;
DROP TABLE CP_PERMISO_PERFIL CASCADE CONSTRAINTS
;
DROP TABLE CP_SEGUIMIENTO CASCADE CONSTRAINTS
;
DROP TABLE CP_SEGUIMIENTO_MENSAJE CASCADE CONSTRAINTS
;
DROP TABLE CP_USUARIO_PERFIL CASCADE CONSTRAINTS
;

CREATE TABLE CP_AUDIT
(
	AUDIT_ID     NUMBER(8) NOT NULL,
	FECHA        DATE NOT NULL,
	TIPO_EVENTO  VARCHAR2(50) NOT NULL,
	COD_USUARIO  VARCHAR2(50) NOT NULL,
	TERMINAL     VARCHAR2(50) NOT NULL,
	ESTADO       VARCHAR2(50) NOT NULL,
	ENTIDAD_ID   NUMBER(8) NOT NULL
)
;


CREATE TABLE CP_AUTOR
(
	AUTOR_ID   NUMBER(8) NOT NULL,
	NOMBRES    VARCHAR2(50) NOT NULL,
	APELLIDO1  VARCHAR2(50) NOT NULL,
	APELLIDO2  VARCHAR2(50),
	CORREO     VARCHAR2(80) NOT NULL
)
;


CREATE TABLE CP_CAMPANIA
(
	CAMPANIA_ID           NUMBER(8) NOT NULL,
	NOMBRE                VARCHAR2(80) NOT NULL,
	DESCRIPCION           VARCHAR2(500),
	AUTOR_ID              NUMBER(8) NOT NULL,
	TIPO                  VARCHAR2(50) NOT NULL,
	ESTADO                VARCHAR2(50) NOT NULL,
	INICIO_CAMPANIA       DATE NOT NULL,
	FIN_CAMPANIA          DATE NOT NULL,
	INICIO_EVENTO         DATE NOT NULL,
	FIN_EVENTO            DATE NOT NULL,
	ASUNTO                VARCHAR2(50),
	MENSAJE               VARCHAR2(1000) NOT NULL,
	MARCACION_AUTOMATICA  VARCHAR2(5),
	APROBADOR             VARCHAR2(50),
	CREADOR               VARCHAR2(50) NOT NULL,
	NO_CIA                VARCHAR2(50),
	CENTRO                VARCHAR2(2),
	NO_CIA_UNID_NEG       VARCHAR2(2),
	UNIDAD_NEGOCIO        VARCHAR2(2),
	DOMINIO               VARCHAR2(80)
)
;


CREATE TABLE CP_CLIENTE
(
	CLIENTE_ID           NUMBER(8) NOT NULL,
	CAMPANIA_ID          NUMBER(8) NOT NULL,
	TIPO_IDENTIFICACION  VARCHAR2(50) NOT NULL,
	IDENTIFICACION       VARCHAR2(50) NOT NULL,
	NOMBRES              VARCHAR2(50) NOT NULL,
	APELLIDO1            VARCHAR2(50),
	APELLIDO2            VARCHAR2(50),
	INDICATIVO           VARCHAR2(4),
	TELEFONO             VARCHAR2(50),
	CELULAR              VARCHAR2(50),
	GENERO               VARCHAR2(1),
	CORREO               VARCHAR2(50),
	EXTRA_STR            VARCHAR2(50),
	EXTRA_NUM            NUMBER(8),
	EXTRA_FECHA          DATE
)
;


CREATE TABLE CP_CONSTANTE
(
	CONSTANTE_ID  VARCHAR2(50) NOT NULL,
	DESCRIPCION   VARCHAR2(50) NOT NULL,
	VALOR         VARCHAR2(50) NOT NULL
)
;


CREATE TABLE CP_DETALLE_AUDIT
(
	DETALLE_ID     NUMBER(8) NOT NULL,
	AUDIT_ID       NUMBER(8) NOT NULL,
	LLAVE_DETALLE  VARCHAR2(50) NOT NULL,
	VALOR_DETALLE  VARCHAR2(50) NOT NULL
)
;


CREATE TABLE CP_ESTADO_SEGUIMIENTO
(
	ESTADO_ID      NUMBER(8) NOT NULL,
	NOMBRE         VARCHAR2(50) NOT NULL,
	DESCRIPCION    VARCHAR2(80) NOT NULL,
	REINTENTAR     VARCHAR2(5) NOT NULL,
	TIPO_CAMPANIA  VARCHAR2(50) NOT NULL
)
;


CREATE TABLE CP_PERFIL
(
	PERFIL_ID  NUMBER(8) NOT NULL,
	NOMBRE     VARCHAR2(50) NOT NULL
)
;


CREATE TABLE CP_PERMISO_PERFIL
(
	PERFIL_ID  NUMBER(8) NOT NULL,
	ACCION     VARCHAR2(50) NOT NULL
)
;


CREATE TABLE CP_SEGUIMIENTO
(
	SEGUIMIENTO_ID    NUMBER(8) NOT NULL,
	CLIENTE_ID        NUMBER(8) NOT NULL,
	CAMPANIA_ID       NUMBER(8) NOT NULL,
	ESTADO            VARCHAR2(50),
	SUBESTADO         NUMBER(8),
	FECHA_ULT_ESTADO  DATE NOT NULL,
	USUARIO           VARCHAR2(50) NOT NULL,
	OBSERVACIONES     VARCHAR2(500),
	DURACION          NUMBER(8),
	LLAMANDO          VARCHAR2(5) NOT NULL
)
;


CREATE TABLE CP_SEGUIMIENTO_MENSAJE
(
	SEG_MENSAJE_ID   NUMBER(8) NOT NULL,
	CLIENTE_ID       NUMBER(8) NOT NULL,
	CAMPANIA_ID      NUMBER(8) NOT NULL,
	ESTADO           VARCHAR2(50) NOT NULL,
	FECHA_ULT_ESTAD  DATE NOT NULL
)
;


CREATE TABLE CP_USUARIO_PERFIL
(
	USU_PER_ID   NUMBER(8) NOT NULL,
	PERFIL_ID    NUMBER(8) NOT NULL,
	COD_USUARIO  VARCHAR2(50) NOT NULL
)
;



ALTER TABLE CP_AUDIT ADD CONSTRAINT PK_CP_AUDIT 
	PRIMARY KEY (AUDIT_ID) 
 USING INDEX 
;

ALTER TABLE CP_AUTOR ADD CONSTRAINT PK_CP_AUTORES 
	PRIMARY KEY (AUTOR_ID) 
 USING INDEX 
;

ALTER TABLE CP_CAMPANIA ADD CONSTRAINT PK_CP_CAMPANIA 
	PRIMARY KEY (CAMPANIA_ID) 
 USING INDEX 
;

ALTER TABLE CP_CLIENTE ADD CONSTRAINT PK_CP_CLIENTE 
	PRIMARY KEY (CLIENTE_ID) 
 USING INDEX 
;

ALTER TABLE CP_CONSTANTE ADD CONSTRAINT PK_CP_CONSTANTES 
	PRIMARY KEY (CONSTANTE_ID) 
 USING INDEX 
;

ALTER TABLE CP_DETALLE_AUDIT ADD CONSTRAINT PK_CP_DETALLE_AUDIT 
	PRIMARY KEY (DETALLE_ID) 
 USING INDEX 
;

ALTER TABLE CP_ESTADO_SEGUIMIENTO ADD CONSTRAINT PK_CP_ESTADO_SEGUIMIENTO 
	PRIMARY KEY (ESTADO_ID) 
 USING INDEX 
;

ALTER TABLE CP_PERFIL ADD CONSTRAINT PK_CP_PERFIL 
	PRIMARY KEY (PERFIL_ID) 
 USING INDEX 
;

ALTER TABLE CP_PERMISO_PERFIL ADD CONSTRAINT PK_CP_PERMISO_ROL 
	PRIMARY KEY (PERFIL_ID, ACCION) 
 USING INDEX 
;

ALTER TABLE CP_SEGUIMIENTO ADD CONSTRAINT PK_CP_SEGUIMIENTO 
	PRIMARY KEY (SEGUIMIENTO_ID) 
 USING INDEX 
;

ALTER TABLE CP_SEGUIMIENTO_MENSAJE ADD CONSTRAINT PK_CP_SEGUIMIENTO_MENSAJE 
	PRIMARY KEY (SEG_MENSAJE_ID) 
 USING INDEX 
;

ALTER TABLE CP_USUARIO_PERFIL ADD CONSTRAINT PK_CP_USUARIOS_PERFIL 
	PRIMARY KEY (USU_PER_ID) 
 USING INDEX 
;



ALTER TABLE CP_CAMPANIA ADD CONSTRAINT FK_CP_CAMPANIA_ARINCD 
	FOREIGN KEY (NO_CIA, CENTRO) REFERENCES ARINCD (NO_CIA, CENTRO)
;

ALTER TABLE CP_CAMPANIA ADD CONSTRAINT FK_CP_CAMPANIA_ARUNNEG 
	FOREIGN KEY (NO_CIA_UNID_NEG, UNIDAD_NEGOCIO) REFERENCES ARUNNEG (NO_CIA, CODIGO)
;

ALTER TABLE CP_CAMPANIA ADD CONSTRAINT FK_CP_CAMPANIA_CP_AUTORES 
	FOREIGN KEY (AUTOR_ID) REFERENCES CP_AUTOR (AUTOR_ID)
;

ALTER TABLE CP_CLIENTE ADD CONSTRAINT FK_CP_CLIENTE_CP_CAMPANIA 
	FOREIGN KEY (CAMPANIA_ID) REFERENCES CP_CAMPANIA (CAMPANIA_ID)
;

ALTER TABLE CP_DETALLE_AUDIT ADD CONSTRAINT FK_CP_DET_AUDIT_CP_AUDIT 
	FOREIGN KEY (AUDIT_ID) REFERENCES CP_AUDIT (AUDIT_ID)
;

ALTER TABLE CP_PERMISO_PERFIL ADD CONSTRAINT FK_CP_PERMISO_ROL_CP_PERFIL 
	FOREIGN KEY (PERFIL_ID) REFERENCES CP_PERFIL (PERFIL_ID)
;

ALTER TABLE CP_SEGUIMIENTO ADD CONSTRAINT FK_CP_SEGUIMIENTO_CP_CAMPANIA 
	FOREIGN KEY (CAMPANIA_ID) REFERENCES CP_CAMPANIA (CAMPANIA_ID)
;

ALTER TABLE CP_SEGUIMIENTO ADD CONSTRAINT FK_CP_SEGUIMIENTO_CP_CLIENTE 
	FOREIGN KEY (CLIENTE_ID) REFERENCES CP_CLIENTE (CLIENTE_ID)
;

ALTER TABLE CP_SEGUIMIENTO ADD CONSTRAINT FK_CP_SEG_CP_SUBESTADO_SEG 
	FOREIGN KEY (SUBESTADO) REFERENCES CP_ESTADO_SEGUIMIENTO (ESTADO_ID)
;

ALTER TABLE CP_SEGUIMIENTO_MENSAJE ADD CONSTRAINT FK_CP_SEG_MSJ_CP_CAMPANIA 
	FOREIGN KEY (CAMPANIA_ID) REFERENCES CP_CAMPANIA (CAMPANIA_ID)
;

ALTER TABLE CP_SEGUIMIENTO_MENSAJE ADD CONSTRAINT FK_CP_SEG_MSJ_CP_CLIENTE 
	FOREIGN KEY (CLIENTE_ID) REFERENCES CP_CLIENTE (CLIENTE_ID)
;

ALTER TABLE CP_USUARIO_PERFIL ADD CONSTRAINT FK_CP_USU_PERFIL_CP_PERFIL 
	FOREIGN KEY (PERFIL_ID) REFERENCES CP_PERFIL (PERFIL_ID)
;
